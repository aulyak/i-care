{"version":3,"file":"/js/view_age.js","mappings":"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","sources":["webpack:///./resources/js/view_age.js"],"sourcesContent":["const dt = luxon.DateTime;\n\nfunction groupScores(arr) {\n  const result = [...arr.reduce((r, o) => {\n    const key = `${o.alert}-${o.bulan_alert}-${o.atribut}`;\n\n    const item = r.get(key) || Object.assign({}, o, {\n      totalScore: 0,\n    });\n\n    item.totalScore += o.score;\n\n    return r.set(key, item);\n  }, new Map()).values()];\n\n  return result;\n}\n\nfunction pivot(arr, bulanAlertList) {\n  const result = [...arr.reduce((r, o) => {\n    const key = `${o.alert}-${o.atribut}`;\n\n    const item = r.get(key) || Object.assign({}, o, bulanAlertList.reduce((acc, curr) => (acc[curr] = 0, acc), {}));\n\n    bulanAlertList.forEach(bulan => {\n      item[bulan] += o[bulan];\n    });\n\n    return r.set(key, item);\n  }, new Map()).values()];\n\n  return result;\n}\n\n$(document).ready(function() {\n  setInterval(() => {\n    const now = dt.now();\n    const currentDtReadable = now.toLocaleString({weekday: 'long', month: 'long', day: '2-digit', year: 'numeric'});\n    const localTime = now.toFormat('HH:mm');\n    $('.date').text(currentDtReadable);\n    $('.time').text(localTime);\n  }, 1000);\n\n  const bulanAlertList = $('#filter-form').data('bulan-alert-list');\n  const filteredData = $('#filter-form').data('filtered-data');\n\n  const filteredValues = Object.values(filteredData);\n  const groupedData = groupScores(filteredValues);\n  const bulanAlertArrHeader = bulanAlertList.map(item => ({\n    data: item,\n    render: function(data, type, row) {\n      if (!data) return '';\n\n      return data;\n    },\n  }));\n\n  const data = groupedData.map((item) => {\n    const excludingBulanAlert = bulanAlertList.filter(row => row !== item.bulan_alert);\n    const tes = excludingBulanAlert.reduce((acc, curr) => (acc[curr] = 0, acc), {});\n    return {\n      alert: item.alert,\n      atribut: item.atribut,\n      [item.bulan_alert]: item.totalScore,\n      ...tes\n    };\n  });\n\n  const pivotData = pivot(data, bulanAlertList);\n\n  const columns = [\n    {data: 'alert'},\n    {data: 'atribut'},\n    ...bulanAlertArrHeader,\n  ];\n\n  $(\"#table-view-by-age\").DataTable({\n    paging: false,\n    dom: \"Bfrtip\",\n    data: pivotData,\n    columns,\n    scrollX: true,\n    buttons: [\"copy\", \"csv\", \"excel\", \"pdf\", \"print\", \"colvis\"],\n    createdRow: function(row, data, dataIndex, cells) {\n      console.log({row, data, dataIndex});\n      if (data.alert === 'BASIC ALERT' || data.alert === 'LEVERAGING') $(row).css({'background-color': '#69AC65'});\n      if (data.alert === 'HIGH ALERT') $(row).css({'background-color': '#F4D165'});\n      if (data.alert === 'VERY HIGH ALERT') $(row).css({'background-color': '#BE2A3E', 'color': 'white'});\n      if (data.alert === 'CHURN RETENTION') $(row).css({'background-color': '#DB5346', 'color': 'white'});\n\n      $(cells).each(function(idx, cell) {\n        if ([0, 1].includes(idx)) $(cell).css({'background-color': 'white', 'color': 'black'});\n      });\n    },\n    columnDefs: [{\n      targets: '_all',\n      createdCell: function(td, cellData, rowData, row, col) {\n        console.log({cellData});\n        if (cellData === 0) {\n          $(td).css('background-color', 'white');\n        }\n      }\n    }],\n  });\n});"],"names":["dt","luxon","DateTime","$","document","ready","setInterval","now","currentDtReadable","toLocaleString","weekday","month","day","year","localTime","toFormat","text","bulanAlertList","data","filteredData","filteredValues","Object","values","groupedData","reduce","r","o","key","alert","bulan_alert","atribut","item","get","assign","totalScore","score","set","Map","bulanAlertArrHeader","map","render","type","row","tes","filter","acc","curr","pivotData","arr","forEach","bulan","pivot","columns","DataTable","paging","dom","scrollX","buttons","createdRow","dataIndex","cells","console","log","css","each","idx","cell","includes","columnDefs","targets","createdCell","td","cellData","rowData","col"],"sourceRoot":""}